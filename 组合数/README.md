### 求组合数

组合数$C_a^b$有很多求法，根据范围和场景不同选取不同的求法。

#### 递推打表（10万组查询，$1\leq b \leq a \leq 2000$）

如果$a$和$b$的范围不大，但是查询次数很多，可以把所有的$C_a^b$打成表，然后每次查表就行了，可以根据递推式：
$$
C_a^b = C_{a-1}^b + C_{a-1}^{b-1}
$$
两重循环来求得。这个式子可以简单证明，$a$个元素里取$b$个，可以先挑一个元素，如果不取这个元素，那就是$C_{a-1}^b$，如果取了这个元素，那么只要再取$b-1$个元素，也就是$C_{a-1}^{b-1}$，两个加起来就是$C_a^b$得所有情况了，不重不漏。

边界：$C_a^0 = 1$。

#### 预处理打表（10万组查询，$1\leq b \leq a \leq 10^5$）

因为$C_a^b$还可以这样求：
$$
C_a^b = \frac{a!}{(b-a)!b!}
$$
可以预处理出每个数的阶乘表：
$$
fact[i] = i! \ mod \ 1e9+7
$$
但是两个数先取模再做除法，和先做除法再取模是不相等的：
$$
\frac{M \ mod \ p}{N \ mod \ p} \neq \frac{M}{N} \ mod \ p
$$
所以可以把每个数阶乘对题目给定的模的乘法逆元也求出来打表：
$$
infact[i] = (i!)^{-1} \ mod \ 1e9 + 7
$$
除法就相当于乘逆元，也就是说：
$$
\frac{M \ mod \ p}{N \ mod \ p} = M \cdot N^{-1}
$$
其中$N^{-1}$是$N$模$p$时候的乘法逆元。

由此，知：
$$
\begin{align}
C_a^b &= \frac{a!}{(b-a)!b!} \\
&= fact[a] \cdot infact[b-a] \cdot infact[b]
\end{align}
$$
这样就能用预处理的结果在$O(1)$的时间里把每个查询的组合数求出来了。一般给出的模是$1e9+7$，是一个质数，所以对这个模的逆元可以用**费马小定理+快速幂**来求。

递归出口$fact[0]=infact[0]=1$，即$0$的阶乘一定是$1$，这个数的逆元也是$1$。

阶乘和阶乘逆元都是递推的过程：
$$
\begin{align}
fact[i] &= fact[i-1] * i \\
infact[i] &= infact[i-1] * i的逆元
\end{align}
$$
 这里是因为对同一个模的逆元是满足乘法结合律的，即
$$
M的逆元 \times N的逆元 = (M \times N)的逆元
$$
所以上面$(i-1)!$的逆元乘以$i$的逆元，就是$i$的阶乘的逆元，就是$infact[i]$了。