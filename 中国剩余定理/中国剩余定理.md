### 中国剩余定理

给定$m_1,m_2,...,m_k$，两两互质，要求下面的同余方程组里的$x$：
$$
\left\{
\begin{array}{lr}
x \equiv a_1 \ (mod \ m_1) \\
x \equiv a_2 \ (mod \ m_2) \\
... \\
x \equiv a_k \ (mod \ m_k)
\end{array}
\right.
$$
只要令$M = m_1 m_2 ... m_k$，即所有的$m_i$乘积，并使得$M_i = \frac{M}{m_i}$，即$M_i$是除了$m_i$之外的其它数相乘，因为前面说了两两互质，且$M_i$里没有因子$m_i$，所以$M_i$和$m_i$是互质的，这样就能用**扩展欧几里得算法**求出$M_i$模$m_i$时的乘法逆元$M_i^{-1}$（注：只有当模数是质数的时候，才能用费马小定理+快速幂来求逆元，仅仅是互质要用扩展欧几里得算法来求逆元）。

则答案就是
$$
x = \sum_{i=1}^n a_iM_iM_i^{-1}
$$
其中每个$M_i^{-1}$都是$M_i$模$m_i$时的乘法逆元。

可以到上面的方程组里验证一下，比如第一行模$m_1$的情况，因为$M_1M_1^{-1}$模$m_1$是$1$，所以$a_1M_1M_1{-1}$模$m_1$就是$a_1$模$m_1$，而其它的加法项里$M_i$都有因子$m_1$，所以其它项模$m_1$是$0$，最终$x$模$m_1$就等于$a_1$模$m_1$。所以第一行成立，其它行也是一样，都是成立的，这样就找出了一个解$x$。