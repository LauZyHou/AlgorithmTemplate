### 欧拉函数

欧拉函数$\phi(n)$是求1~n中与n互质的元素个数
如1~6中1、5两个数和6互质，所以$\phi(6)=2$

#### 解法
将n因式分解为$n=p_1^{a_1}+p_2^{a2}+...+p_k^{a_k}$

则$\phi(n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k}$)

例如$n = 6 = 2 \times 3$
$\phi(6) = 6 \times (1 - \frac{1}{2}) \times (1 - \frac{1}{3}) = 2$

#### 证明

因为要求1~n中与n互质的元素个数

先求n的质因数$p_1..p_k$，接下来用容斥原理的思想

把$p_1$的所有倍数、$p_2$的所有倍数...$p_k$的所有倍数去掉

但是$p_i$和$p_j$的所有倍数被多去了一次，要加回来

$p_i$、$p_j$、$p_r$的所有倍数又多加了一次，要减回去

.....

最终结果就是
$$
N - \frac{N}{p_1} - \frac{N}{p_2} - ... - \frac{N}{p_k} \\
 + \frac{N}{p_1p_2} + \frac{N}{p_2p_3} + ... \\
 - \frac{N}{p_1p_2p_3} - ... \\
 + ... \\
 - ... \\
 ...
$$
这个式子可以化简成
$$
\phi(n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})
$$

#### 线性筛法求欧拉函数

在线性筛求1~n之间的质数表的过程中，可以顺便求每个数的欧拉函数，时间复杂度是$O(n)$。

特殊的$\phi(1)=1$。

i从2到n，如果i是一个质数，根据定义，$phi(i)=i-1$，因为从1到i-1都和i互质，数目是i-1。

在线性筛筛掉一个非质数`i * primes[j]`的时候，如果`i % primes[j] == 0`成立，也就是说`primes[j]`是`i`的最小质因数，同时也是`i * primes[j]`的最小质因数。

根据最上面的求欧拉函数的公式，在求$phi(i)$的过程中已经乘过了$(1 - \frac{1}{primes[j]})$这一项，在$phi(i * primes[j])$里的后面的括号里的因子也和$\phi(i)$的一样，所以就只是把第一项`i`变成了`i * primes[j]`就完事了。

在线性筛筛掉一个非质数`i * primes[j]`的时候，如果`i % primes[j] != 0`成立，也就是说`primes[j]`不是`i`的一个因子，是比`i`的最小质因数更小的一个质数，所以在$phi(i * primes[j])$里后面的括号因子比$\phi(i)$多了一项$(1 - \frac{1}{primes[j]})$这一项，然后还要把第一项`i`变成`i * primes[j]`。

综上所述，在在线性筛筛掉一个非质数`i * primes[j]`的时候：
$$
phi(i \cdot primes[j]) = 
	\left\{
    \begin{array}{lr}
             phi(i) \cdot primes[j], & 当 i \% primes[j] = 0 \\
             phi(i) \cdot (primes[j] - 1), & 当 i \% primes[j] \neq 0
    \end{array}
	\right.
$$

### 欧拉定理

若$a$与$n$互质，则$a^{\phi(n)} \ mod \ n \ = \ 1$。

