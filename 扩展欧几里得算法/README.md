### 裴蜀定理

对于任意正整数$a$，$b$，一定存在非零整数$x$，$y$，一个正一个负，使得
$$
a \cdot x + b \cdot y = gcd(a,\ b)
$$
也就是说$a$和$b$的最大公约数是它们两个能凑出来的最大正整数。

### 扩展欧几里得算法

扩展欧几里得算法就是用来求上面裴蜀定理定义的$x$和$y$的，即给定$a$和$b$，求能让它们凑出$gcd(a,\ b)$的系数$x$和$y$。

欧几里得算法是约数那一节学的，利用
$$
gcd(a,\ b) = gcd(b,\ a \ mod \ b)
$$
这个式子来的，特别地，$a$和$0$的最大公约数就是$a$。

扩展欧几里得算法在用欧几里得算法求gcd的过程中维护$x$和$y$，向上把顶层的$x$和$y$求出来，在递归出口$b=0$时，因为gcd就等于$a$，所以$x=1$，$y=0$就行。

#### 具体思路和过程

见代码

#### 求所有的x和y

只要求出一组$x_0$和$y_0$满足$ax_0 + by_0 = d$，那么就能求出所有的解（$k \in \mathbb{Z}$）：
$$
\left\{
\begin{array}{lr}
x &= x_0 - \frac{b}{d}\cdot k \\
y &= y_0 + \frac{a}{d}\cdot k
\end{array}
\right.
$$

后面补的加减项总是会抵消，使得最后结果还是$d$。

### 习题：线性同余方程

欧几里得算法的一个应用就是用来求解线性同余方程，给定$a$、$b$和$m$，求解任意一个int范围内的$x$，使得：
$$
a\cdot x \equiv b \ (mod \ m)
$$
也可能找不到这样的$x$，那么就是无解的。

上式等价于存在一个$y \in \mathbb{Z}$，使得
$$
a \cdot x = m \cdot y + b
$$
所以
$$
a \cdot x - m \cdot y = b
$$
将符号放到$y$里去，变成$y'$，即
$$
a \cdot x + m \cdot y' = b
$$
也就是给定$a$、$m$和$b$，要找到一组$x$和$y'$（实际上只关心$x$），使得上面的等式成立，原式有解就是上面的等式有解。

上面的等式有解的充要条件是$b$是$gcd(a,\ m)$的倍数，因为$a$是$gcd(a,\ m)$的倍数，$m$也是$gcd(a,\ m)$的倍数，它们通过系数$x$和$y'$拼到一起也一定是$gcd(a,\ m)$的倍数。

通过扩展欧几里得算法可以求出$x$和$y'$使得
$$
a \cdot x + m \cdot y' = gcd(a,\ m)
$$
因为题中的$b$是这个gcd的倍数，所以只要把两个系数也扩大这么多倍就行了。